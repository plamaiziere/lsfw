--- probe ---

probe [on equipment-spec] source destination
[tcp | udp [portsource:][portdest]] |
[icmp [icmptype]] |
[icmp6 icmp6type]] |
[protocol]

  The probe command probes the network from a source IP address to a destination IP
address. Optionally, the protocol and dependent options can be specified.

on equipment-spec
------------------
  By default, Jtacl tries to find a network equipment where the probe will be
injected using the source IP address. If there is zero or more than one candidate,
Jtacl rejects the command with an error.

  The 'on' keyword allows to specify one interface on a network equipement
where the probe will be injected. The equipment specification specifies the
name of the equipment, followed by a '|' and then followed by the name
of an interface or an IP address:

equipments-spec: equipment'|'interface-name | ip address.

  If an interface name is specified, Jtacl uses the first link available on this
interface, regardless of the source IP address of the probe (a link describes
one network connected to an interface).
  If an IP address is specified, Jtacl uses this IP address to find the link,
regardless of the source IP address of the probe.
  If the DFLTEQUIPMENT variable is defined, Jtack uses this variable as a default
equipment specification when no candidate link is found for IPv4 addresses.
  If the DFLTEQUIPMENT6 variable is defined, Jtack uses this variable as a default
equipment specification when no candidate link is found for IPv6 addresses.

Addresses
---------
  Source and destination addresses can be a hostname, an IP address or a
network. If a hostname is specified, it is resolved using DNS.

Protocol
--------

  The protocol is specified using a number or the name of the protocol.
Names are resolved using an internal database.

udp/tcp
-------
  If the protocol is udp or tcp, port source and port destination can be specified
using the form [portsource:][portdest]

  Port can be a number or the name of a service. Services are resolved using
an internal services database.

icmp/icmp6
-----------
  If the protocol is icmp or icmp6, the icmp-type or icmp message can be added.

  Icmp-type/icmp6-type can be a number or the name of an icmp-type or icmp
message. Names are resolved using an internal database.

Examples:
---------

  Probe from 192.168.1.2 to google, no protocol specification
  jtacl> probe 192.168.1.2 www.google.com

  Probe from the network 192.168.1.2/24 to google, no protocol specification
  jtacl> probe 192.168.1.2/24 www.google.com

  Same for tcp and http for the destination port.
  jtacl> probe 192.168.1.2/24 www.google.com tcp http

  Port source http
  jtacl> probe 192.168.1.2/24 www.google.com tcp http:

  Port source and port dest
  jtacl> probe 192.168.1.2/24 www.google.com tcp 1024:http

  Icmp echo
  jtacl> probe 192.168.1.2/24 1.2.3.4 icmp echo

  Probe from the equipment "router1", interface 'if0' using an equipment
  specification
  jtacl> probe on router1|if0 192.168.1.2/24 1.2.3.4 icmp echo
 